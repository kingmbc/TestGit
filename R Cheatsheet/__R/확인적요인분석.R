############################################################
# ì‘ ì„± ì : ì¡° ì • í˜¸
# ì¼ ì‹œ : 2014. 10. 08.
# ë²” ìœ„ : SPSS AMOS êµ¬ì¡°ë°©ì •ì‹ -> Rì„ ì´ìš©í•œ í™•ì¸ì  ìš”ì¸ë¶„ì„
############################################################
############################################################
# í™•ì¸ì ìš”ì¸ë¶„ì„ì„ í•˜ê¸° ìœ„í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
############################################################
install.packages("lavaan", dependencies=TRUE);
library(lavaan);
############################################################# í™•ì¸ì ìš”ì¸ë¶„ì„ì— ì“°ì´ëŠ” ëŒ€í‘œì ì¸ ë°ì´í„°
############################################################
data(HolzingerSwineford1939);
str(HolzingerSwineford1939);
head(HolzingerSwineford1939); # HolzingerSwineford1939 dataì˜ ì•ë¶€ë¶„ì„ í™•ì¸í•´ë³´ë‹ˆ,
example(cfa);
###########################################################*#example,(cfa);
# 1. lavaanì—ëŠ” ì €ìì˜ ë…¼ë¬¸ë„ ì¢‹ê³ ,
# 2. lavaanì˜ cfa()ì— ê´€í•œ ì˜ˆì œë¥¼ ì‚´í´ë³´ë©´ ë©ë‹ˆë‹¤.
############################################################
# dataì„¤ëª…
# ë‘ê°œì˜ ë‹¤ë¥¸ í•™êµì—ì„œ 7,8í•™ë…„ì˜ ì‹œí—˜ì ìˆ˜ë¥¼ í†µí•œ ì •ì‹ ì ì¸ ëŠ¥ë ¥ì— ëŒ€í•œ ë°ì´í„°ì´ë‹¤.
# ë³€ìˆ˜ì„¤ëª…
# ëª…ëª©ë³€ìˆ˜
# id, sex, ageyr(age,yearpart), agemo(age,monthpart), school(Patuer or Grant-White), grade(grade),
# ì—°ì†ë³€ìˆ˜
# x1(Visual perception), x2(Cubes), x3(Lozenges), x4(Paragraph comprehension), x5(Setence completion)
# x6(Word meaning), x7(Speeded addition), x8(Speeded countin of dots), 
# x9(Speeded descrimination straight and curved capitals)
# ageyr í•™ìƒì˜ ë‚˜ì´
# agemo í•™ìƒì´ ë‹¤ë‹Œ ê°œì›”ìˆ˜
# grade í•™ìƒì˜ í•™ë…„
############################################################
########################################################################################################
# HozingerSwineford1939 ë°ì´í„°ì˜ ê° ë³€ìˆ˜ì˜ ë¶„í¬ íŒŒì•…
########################################################################################################
# ì„±ë³„ë³€ìˆ˜ì— ëŒ€í•œ ë¶„í¬ íŒŒì•…
table(HolzingerSwineford1939$sex); 
# í•™ìƒì˜ ë‚˜ì´ë³€ìˆ˜ì— ëŒ€í•œ ë¶„í¬ íŒŒì•…
table(HolzingerSwineford1939$ageyr); 
# í•™ìƒì˜ í•™êµë‹¤ë‹Œ ê°œì›”ìˆ˜ì— ëŒ€í•œ ë¶„í¬ íŒŒì•…
table(HolzingerSwineford1939$agemo); 
# í•™ìƒì´ ë‹¤ë‹Œ í•™êµì— ëŒ€í•œ ë¶„í¬ íŒŒì•…
table(HolzingerSwineford1939$school); 
# í•™ìƒì˜ í•™ë…„ì— ëŒ€í•œ ë¶„í¬ íŒŒì•…
table(HolzingerSwineford1939$grade); 
############################################################
############################################
## The famous Holzinger and Swineford (1939) example
############################################################
HS.model <- ' visual =~ x1 + x2 + x3
textual =~ x4 + x5 + x6
speed =~ x7 + x8 + x9 ';
fit <- cfa(HS.model, data=HolzingerSwineford1939);
summary(fit, fit.measures=TRUE) ;
# í™•ì¸ì ìš”ì¸ë¶„ì„ ê²°ê³¼ì— ëŒ€í•œ ìš”ì•½í†µê³„ë­